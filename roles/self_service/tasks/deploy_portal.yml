#SPDX-License-Identifier: MIT-0
---
# Deploy self-service portal tasks
# This is the actual deployment logic
# NOTE: Plugin download happens in the main workload before this runs

- name: Create OAuth2 application in AAP
  include_tasks: oauth.yml

- name: Create AAP token
  include_tasks: create_token.yml

- name: Create OpenShift namespace
  include_tasks: namespace.yml

- name: Create OpenShift secrets
  include_tasks: oc_secrets.yml

- name: Build plugin registry
  include_tasks: plugins.yml

- name: Deploy plugin registry app
  include_tasks: plugin_deploy.yml

- name: Generate Helm values with plugin integrity
  include_tasks: helm_values.yml

- name: Update AAP OAuth2 application with RHAAP route
  include_tasks: update_aap_oauth.yml
